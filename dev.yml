- name: Setting up development environment
  hosts: localhost
  gather_facts: true
  become: false

  vars_files:
    - ansible/packages.yml
    - ansible/dots.yml
  
  tasks:
    - name: Install packages for WSL
      include_tasks: ansible/windows/dev.yml
      when:
        - ansible_facts['virtualization_type'] == "wsl"

    - name: Install packages for Arch Linux
      include_tasks: ansible/arch/dev.yml
      when:
      - ansible_facts['os_family'] == "Archlinux" or ansible_facts['distribution'] == "Arch"

    - name: Perform common config tasks
      include_tasks: ansible/common/dev.yml

    - name: Setup dotfiles
      ansible.builtin.copy:
        src: "{{ playbook_dir }}/{{ item.src }}"
        dest: "{{ ansible_env.HOME }}/{{ item.dest }}"
        owner: "{{ ansible_user_id }}"
        group: "{{ ansible_user_id }}"
        mode: '0755'
      loop: "{{ dots_common }}"
      when: item.src is defined and item.dest is defined